<div class="page">
  <header class="page__header">
    <button class="back-btn" type="button" routerLink="/">‚Üê</button>
    <h2>Resumen</h2>
  </header>

  <!-- üîπ Resumen de HOY -->
  <section class="section">
    <h3>Hoy ({{ todaySummary.date }})</h3>

    <div class="cards">
      <div class="card">
        <span class="label">Vendido (contado)</span>
        <span class="value"> RD$ {{ todaySummary.totalSales | number : '1.0-0' }} </span>
      </div>

      <div class="card">
        <span class="label">Fiado hoy</span>
        <span class="value"> RD$ {{ todaySummary.totalCreditSales | number : '1.0-0' }} </span>
      </div>

      <div class="card">
        <span class="label">Cobrado de fiado</span>
        <span class="value"> RD$ {{ todaySummary.totalCreditPayments | number : '1.0-0' }} </span>
      </div>

      <div class="card">
        <span class="label">Pagos a proveedores</span>
        <span class="value">
          RD$
          {{ todaySummary.totalSupplierPayments | number : '1.0-0' }}
        </span>
      </div>

      <div class="card card--highlight">
        <span class="label">Ganancia estimada</span>
        <span class="value"> RD$ {{ todaySummary.estimatedProfit | number : '1.0-0' }} </span>
      </div>
    </div>
  </section>

  <!-- üîπ Resumen por MES de un a√±o -->
  <section class="section" *ngIf="availableYears.length > 0">
    <div class="section__header">
      <h3>Por mes</h3>

      <label class="year-select">
        <span>A√±o:</span>
        <select [value]="selectedYear" (change)="onYearChange($any($event.target).value)">
          <option *ngFor="let y of availableYears" [value]="y">
            {{ y }}
          </option>
        </select>
      </label>
    </div>

    <p *ngIf="monthlySummaries.length === 0" class="empty">No hay datos para este a√±o.</p>

    <div *ngIf="monthlySummaries.length > 0" class="table">
      <div class="table__header">
        <span>Mes</span>
        <span>Vendido</span>
        <span>Cobrado fiado</span>
        <span>Proveedores</span>
        <span>Ganancia</span>
      </div>

      <div
        class="table__row table__row--clickable"
        *ngFor="let m of monthlySummaries"
        (click)="showDailyDetailsForMonth(m)"
      >
        <span>{{ getMonthName(m.month) }}</span>
        <span>RD$ {{ m.totalSales | number : '1.0-0' }}</span>
        <span>RD$ {{ m.totalCreditPayments | number : '1.0-0' }}</span>
        <span>RD$ {{ m.totalSupplierPayments | number : '1.0-0' }}</span>
        <span>RD$ {{ m.estimatedProfit | number : '1.0-0' }}</span>
      </div>
    </div>
  </section>

  <section class="section" *ngIf="selectedMonthForDetails">
    <h3>
      Detalle por d√≠a ‚Äì
      {{ getMonthName(selectedMonthForDetails.month) }}
      {{ selectedMonthForDetails.year }}
    </h3>

    <p *ngIf="dailySummariesForSelectedMonth.length === 0" class="empty">
      No hay datos diarios para este mes.
    </p>

    <div class="table" *ngIf="dailySummariesForSelectedMonth.length > 0">
      <div class="table__header">
        <span>D√≠a</span>
        <span>Vendido</span>
        <span>Cobrado fiado</span>
        <span>Proveedores</span>
        <span>Ganancia</span>
      </div>

      <div class="table__row" *ngFor="let d of dailySummariesForSelectedMonth">
        <span>{{ d.date.slice(8, 10) }}</span>
        <span>RD$ {{ d.totalSales | number : '1.0-0' }}</span>
        <span>RD$ {{ d.totalCreditPayments | number : '1.0-0' }}</span>
        <span>RD$ {{ d.totalSupplierPayments | number : '1.0-0' }}</span>
        <span>RD$ {{ d.estimatedProfit | number : '1.0-0' }}</span>
      </div>
    </div>
  </section>

  <!-- üîπ Resumen por A√ëO -->
  <section class="section" *ngIf="yearlySummaries.length > 0">
    <h3>Por a√±o</h3>

    <div class="table">
      <div class="table__header">
        <span>A√±o</span>
        <span>Vendido</span>
        <span>Cobrado fiado</span>
        <span>Proveedores</span>
        <span>Ganancia</span>
      </div>

      <div class="table__row" *ngFor="let y of yearlySummaries">
        <span>{{ y.year }}</span>
        <span>RD$ {{ y.totalSales | number : '1.0-0' }}</span>
        <span>RD$ {{ y.totalCreditPayments | number : '1.0-0' }}</span>
        <span>RD$ {{ y.totalSupplierPayments | number : '1.0-0' }}</span>
        <span>RD$ {{ y.estimatedProfit | number : '1.0-0' }}</span>
      </div>
    </div>
  </section>
</div>
