<div class="page">
  <header class="page__header">
    <button class="back-btn" type="button" routerLink="/">â†</button>
    <h2>Clientes</h2>
  </header>

  <section class="section">
    <h3>{{ editingClient ? 'Editar cliente' : 'Registrar nuevo cliente' }}</h3>

    <form [formGroup]="form" (ngSubmit)="save()" class="form">
      <div class="form__row">
        <label class="field">
          <span>NÃºmero de cliente</span>
          <input type="text" formControlName="code" />
          <small *ngIf="codeInvalid">Escribe un nÃºmero o cÃ³digo.</small>
        </label>

        <label class="field">
          <span>Nombre</span>
          <input type="text" formControlName="name" />
          <small *ngIf="nameInvalid">Escribe el nombre del cliente.</small>
        </label>
      </div>

      <label class="field">
        <span>Nota / referencia (opcional)</span>
        <textarea formControlName="note" rows="2"></textarea>
      </label>

      <div class="actions">
        <button
          *ngIf="editingClient"
          type="button"
          class="btn btn--secondary"
          (click)="cancelEdit()"
        >
          Cancelar
        </button>

        <button type="submit" class="btn btn--primary">
          {{ editingClient ? 'Guardar cambios' : 'Guardar' }}
        </button>
      </div>
    </form>
  </section>

  <section class="section">
    <p *ngIf="clients.length === 0" class="empty">AÃºn no has registrado clientes.</p>

    <section class="section">
      <h3>Lista de clientes</h3>

      <app-search-filter
        label="Buscar cliente"
        placeholder="Por nÃºmero, nombre o referencia"
        (search)="onSearchClients($event)"
      ></app-search-filter>

      <p *ngIf="clients.length === 0" class="empty">
        No hay clientes que coincidan con la bÃºsqueda.
      </p>
    </section>

    <ul *ngIf="clients.length > 0" class="list">
      <li *ngFor="let c of clients" class="item" [class.item--inactive]="!c.isActive">
        <div class="item__header">
          <div class="item__main">
            <span class="item__code">#{{ c.code }}</span>
            <span class="item__name">{{ c.name }}</span>
          </div>

          <div class="item__actions">
            <button
              type="button"
              class="btn-icon"
              (click)="startEdit(c)"
              title="Editar cliente"
            >
              âœï¸
            </button>

            <button
              type="button"
              class="btn-icon btn-icon--danger"
              (click)="deleteClient(c)"
              title="Eliminar cliente"
            >
              ğŸ—‘ï¸
            </button>
          </div>
        </div>

        <p class="item__note" *ngIf="c.note">
          {{ c.note }}
        </p>

        <button type="button" class="status-btn" (click)="toggleActive(c)">
          {{ c.isActive ? 'Activo' : 'Inactivo' }}
        </button>
      </li>
    </ul>
  </section>
</div>
